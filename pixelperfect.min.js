(function(){"use strict";((r={})=>{if(!window||window.isPPLoaded)return;const l="pixelperfect",a="index",c=[320,768,1240],h="pixelperfect",p="jpg",_={ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0],ArrowUp:[0,-1]},f=(s,e)=>s-e,P=s=>s.ctrlKey||s.shiftKey||s.altKey||s.metaKey;class d{constructor(){const{breakpoints:e=null,ext:t=p,folder:o=h,page:n=null,selector:m="body"}=window.pixelperfect||r;if(this._isPP=!!Number(localStorage.getItem("pp")||0),this._isInvert=!!Number(localStorage.getItem("ppInvert")||1),this._breakpoints=e?Array.from(new Set(e)).sort(f):c,this._currentBreakpoint=0,this._folder=o,this._ext=t,this._PPElement=document.querySelector(m),n)this._page=n;else{const[,i=null]=window.location.pathname.match(/^\/?(.*?)(\.html?)?$/)||[];this._page=i.replace(/\/$/,"")||a}this._offsets=JSON.parse(localStorage.getItem("ppOffsets"))||{},this._offsets[this._page]||(this._offsets[this._page]={});for(const i of this._breakpoints)this._offsets[this._page][i]||(this._offsets[this._page][i]=[0,0]);this._saveOffsets(),this._keydownHandler=this._keydownHandler.bind(this),this._changeScreenMode=this._changeScreenMode.bind(this),this._changeScreenMode(),this._setOffsets(),this._managePP(),this._manageInvert(),window.addEventListener("resize",this._changeScreenMode),document.addEventListener("keydown",this._keydownHandler)}_changeScreenMode(){const{clientWidth:e}=this._PPElement;let t=0;for(const o of this._breakpoints)e<o||(t=o);this._currentBreakpoint!==t&&(this._currentBreakpoint=t,this._setBgProperty(this._currentBreakpoint),this._setOffsets())}_keydownHandler(e){if(!(document.activeElement!==document.body||P(e))){if(e.code==="KeyP")e.preventDefault(),this._isPP=!this._isPP,this._managePP();else if(this._isPP&&e.code==="KeyI")e.preventDefault(),this._isInvert=!this._isInvert,this._manageInvert();else if(this._isPP&&e.code==="KeyR")e.preventDefault(),localStorage.removeItem("ppOffsets"),window.location.reload();else if(this._isPP){const t=_[e.code];if(!t)return;e.preventDefault(),this._movePP(...t)}}}_manageInvert(){this._PPElement.style.setProperty("--pp-filter",this._isInvert?"invert(1)":"none"),localStorage.setItem("ppInvert",Number(this._isInvert))}_managePP(){getComputedStyle(this._PPElement).position==="fixed"?(this._scrollableElement=document.documentElement,this._scrollTop=this._PPElement.scrollTop):(this._scrollableElement=this._PPElement,this._scrollTop=document.documentElement.scrollTop);const e=getComputedStyle(this._PPElement).scrollBehavior;this._PPElement.classList.toggle(l,this._isPP),this._PPElement.style.scrollBehavior="auto",this._scrollableElement.scroll(0,this._scrollTop),this._PPElement.style.scrollBehavior=e,localStorage.setItem("pp",Number(this._isPP))}_movePP(e,t){this._offsets[this._page][this._currentBreakpoint][0]+=e,this._offsets[this._page][this._currentBreakpoint][1]+=t,this._saveOffsets(),this._setOffsets()}_saveOffsets(){localStorage.setItem("ppOffsets",JSON.stringify(this._offsets))}_setBgProperty(e=0){const t=e?`url("${this._folder}/${this._page}-${e}.${this._ext}")`:"none";this._PPElement.style.setProperty("--pp-img",t)}_setOffsets(){const[e=0,t=0]=this._offsets[this._page][this._currentBreakpoint]||[];this._PPElement.style.setProperty("--pp-offset-x",`${e}px`),this._PPElement.style.setProperty("--pp-offset-y",`${t}px`)}}document.head.insertAdjacentHTML("beforeend",'<style>.pixelperfect{position:relative;overflow-x:hidden;overflow-y:auto}.pixelperfect::after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;z-index:1000000;background-image:var(--pp-img);background-repeat:no-repeat;background-position:calc(50% + var(--pp-offset-x)) var(--pp-offset-y);opacity:.5;filter:var(--pp-filter);pointer-events:none}</style>'),new d,window.isPPLoaded=!0})()})();
